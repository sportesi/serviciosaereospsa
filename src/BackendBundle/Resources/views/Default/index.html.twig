{% extends 'BackendBundle::layout.html.twig' %}

{% block styles %}
    <style type="text/css">
        th{
            text-align: center !important; 
        }
        .rotate{
            transform: rotate(-90deg);
            vertical-align: middle !important;
            text-align: center !important;
            line-height: 1 !important;
            padding: 0 !important;
        }
        tbody td{
            text-align: center;
        }
    </style>
{% endblock %}

{% block scripts %}
    <!-- Moment JS -->
    <script type="text/javascript" src="{{ asset("/bundles/backend/bower_components/moment/min/moment-with-locales.min.js") }}"></script>

    <script type="text/javascript">

        moment.locale('es');

        var date = moment().add({{ date | number_format }}, 'w').format()

        var start = moment(date).startOf('week').format('DD')
        var end = moment(date).endOf('week').format('DD')
        var month = moment(date).format('MMMM')
        var semanaText = 'Semana del ' + start + ' al ' + end + ' del mes de ' + month.capitalizeFirstLetter()
        $('#semanaText').text(semanaText);

        $('.rotate').each(function(){
            $(this).find('b').text(moment(date).day($(this).data('dia')).format('DD'))
        })

    </script>
{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">
                <i class="fa fa-table fa-fw"></i> Turnos
                <div class="pull-right">
                    <h3 style="margin: 10px; " id="semanaText" ></h3>
                </div>
            </h1>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
        	<div class="table-responsive">
        		<table class="table table-striped table-bordered table-hover">
        			<thead>
        				<tr>
        					<th colspan="2">Hora</th>
        					{% for itemHorario in horarios %}
                                <th>{{ itemHorario.hora }}</th>
                            {% endfor %}
        				</tr>
        				<tr>
        					<th width="1%">D&iacute;a</th>
        					<th>Mat</th>
        					{% for itemHorario in horarios %}
                                <th>Piloto</th>
                            {% endfor %}
        				</tr>
        			</thead>
        			<tbody>
                        {% for itemDia in dias %}
            				<tr>
            					<td colspan="1" rowspan="{{ aviones|length + 1 }}" data-dia="{{ itemDia.id }}" class="rotate">{{ itemDia.nombre }}<br><b></b></td>
            				</tr>
                            {% for itemAvion in aviones %}
            				    <tr data-dia="{{ itemDia.id }}" data-avion="{{ itemAvion.id }}">
                                    <td>{{ itemAvion.matricula }}</td> 
                                    {% for itemHorario in horarios %}
                                        <td data-horario="{{ itemHorario.id }}"></td>
                                    {% endfor %} 
                                </tr>
                            {% endfor %}
                        {% endfor %}
        			</tbody>
        		</table>
        	</div>
        </div>
    </div>
{% endblock %}